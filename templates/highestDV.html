<!-- highestDV.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/static/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Highest DV</title>
    <!-- Add your CSS styles here if needed -->
</head>
<body>



<div id="rankings-container">
    <!-- Top 3 Rankings -->
    <div class="ranking" id="rank1"></div>
    <div class="ranking" id="rank2"></div>
    <div class="ranking" id="rank3"></div>
</div>

<script>
    // Initialize an array to store the badge values
    let badgeValues = [];

    // Function to update the badge table
    function updateBadgeTable() {
        // Sort the badge values in descending order
        badgeValues.sort((a, b) => {
            // Compare the values based on the sum
            const sumA = a.reduce((acc, val) => acc + val, 0);
            const sumB = b.reduce((acc, val) => acc + val, 0);
            return sumB - sumA;
        });

        // Get the rankings-container element
        const rankingsContainer = document.getElementById("rankings-container");

        // Clear existing rankings in the container
        rankingsContainer.innerHTML = '';

        // Add sections for the top 3 badge values
        for (let i = 0; i < Math.min(badgeValues.length, 3); i++) {
            const rankElement = document.createElement('div');
            rankElement.className = 'ranking';

            // Set the content for each ranking
            rankElement.innerHTML = `
                <span>ATK: ${badgeValues[i][0]}</span><br>
                <span>DEF: ${badgeValues[i][1]}</span><br>
                <span>SPE: ${badgeValues[i][2]}</span><br>
                <span>SPD: ${badgeValues[i][3]}</span><br>
                <img src="gifFilePath" alt="GIF File Content"><br>
                <span>ITEM: ${badgeValues[i][4]}</span><br><br>
            `;

            // Append the ranking section to the container
            rankingsContainer.appendChild(rankElement);
        }
    }

    // Function to receive values from Flask server
    function receiveValuesFromServer(data) {
        // Check if all required fields are present in the received data
        if ('Attack' in data && 'Defense' in data && 'Speed' in data && 'Special' in data && 'item_name' in data) {
            // Add the new badge values to the array
            badgeValues.push([
                data['Attack'],
                data['Defense'],
                data['Speed'],
                data['Special'],
                data['item_name']
            ]);

            // Update the table
            updateBadgeTable();
        } else {
            console.error('Received data is missing required fields:', data);
        }
    }

    // Fetch the latest badge values from Flask server
    function fetchLatestBadgeValues() {
        fetch('/get_badge_values')
            .then(response => response.json())
            .then(data => receiveValuesFromServer(data))
            .catch(error => console.error('Error fetching latest badge values:', error));
    }

    // Simulate data changes every few seconds (replace with your actual update mechanism)
    setInterval(() => {
        // Fetch the latest badge values from Flask server
        fetchLatestBadgeValues();
    }, 5000);
</script>

</body>
</html>
